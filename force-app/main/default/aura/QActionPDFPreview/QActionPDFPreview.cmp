<aura:component implements="force:appHostable,force:hasRecordId,force:lightningQuickAction,lightning:actionOverride,flexipage:availableForAllPageTypes" access="global" controller="QActionPDFPreviewController">

	<!-- INCLUDE -->
	<ltng:require scripts="{!$Resource.LightningNotifications + '/js/common.js'}"/>

	<!-- HANDLERS -->
	 <aura:handler name="init" value="{!this}" action="{!c.init}" /> 

	<!-- ATTRIBUTTES -->
    <aura:attribute name="isReady" type="Boolean" default="false"/>
	<aura:attribute name="isLoading" type="Boolean" default="true" />

	<aura:attribute name="recordId" type="String"/>
	<aura:attribute name="pdfType" type="String"/>
	<aura:attribute name="quoteMdl" type="Object"/>
	<aura:attribute name="quoteMdlView" type="Object"/>
	<aura:attribute name="canSave" type="Boolean" default="true"/>
	<aura:attribute name="hasTmplProd" type="Boolean" default="false"/>

	<aura:attribute access="private" name="fnOnClose" type="Object" description="Function to be called on modal close, if not onUpdate fired by saving (insert or direct edit)."/>


	<div class="preview">
		<!-- HEADER -->
		<aura:if isTrue="{!!v.canSave}">
			<div style="text-align:center; font-size: 20px; background-color:orange">The document was created for current Quote.</div>
		</aura:if>
		<aura:if isTrue="{!v.hasTmplProd}">
			<div style="text-align:center; font-size: 20px; background-color:orange">Quote contains Template Products.</div>
		</aura:if>
		<div class="slds-page-header">
			<div class="slds-page-header__row">
				<div class="slds-page-header__col-title">
					<div class="slds-media">
						<div class="slds-media__figure">
				          	<lightning:icon iconName="doctype:pdf" alternativeText="Test" />
						</div>
						<div class="slds-media__body">
				        	<div class="slds-page-header__name">
				        		<div class="slds-page-header__name-title">
				            		<h1>
				            			<span class="slds-page-header__title slds-truncate">PDF Preview</span>
										<span >{!v.quoteMdlView.qt.Pricebook2.Name}</span>
				            		</h1>
				            	</div>
				          	</div>
						</div>
					</div>
				</div>
				<div class="slds-page-header__col-actions">
						<div class="slds-page-header__controls">
						<div class="slds-page-header__control">
							<ul class="slds-button-group-list">
								<li>
									<button class="slds-button slds-button_brand" onclick="{!c.savePdf}" disabled="{!if(or(!v.canSave, v.hasTmplProd), 'disabled', '')}">Save PDF</button>
								</li>
								<li>
									<button class="slds-button slds-button_neutral" onclick="{!c.backBtn}">Back</button>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
		<aura:if isTrue="{!v.pdfType=='QuotePDF'}">
			<iframe src="{! '/apex/QuotePdf?id=' + v.recordId }"  frameBorder="0" width="100%" height="650px"/>
		<aura:set attribute="else">
			<iframe src="{! '/apex/SpecificationPdf?id=' + v.recordId }"  frameBorder="0" width="100%" height="650px"/>
		</aura:set>
		</aura:if>
	</div>
</aura:component>